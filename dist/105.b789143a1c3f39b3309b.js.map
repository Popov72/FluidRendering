{"version":3,"file":"105.b789143a1c3f39b3309b.js","mappings":"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","sources":["webpack://babylonjs-fluid-rendering/./src/assets/scenes/simple_round_table.glb","webpack://babylonjs-fluid-rendering/./src/scenes/fluidSimulationDemoGlass.ts"],"sourcesContent":["export default __webpack_public_path__ + \"370c162a33a228937af8f45b74b949f4.glb\";","import * as BABYLON from \"@babylonjs/core\";\r\n\r\nimport { FluidSimulationDemoBase } from \"./fluidSimulationDemoBase\";\r\n\r\n// Table from YouniqueÄªdeaStudio (https://sketchfab.com/3d-models/simple-round-table-obj-6083c7dd80034ed5a6425a5fe7bcdf9a)\r\nimport tableScene from \"../assets/scenes/simple_round_table.glb\";\r\n\r\nexport class FluidSimulationDemoGlass extends FluidSimulationDemoBase {\r\n    private _boxMesh: BABYLON.Nullable<BABYLON.Mesh>;\r\n    private _boxMaterial: BABYLON.Nullable<BABYLON.PBRMaterial>;\r\n    private _cylMesh: BABYLON.Nullable<BABYLON.Mesh>;\r\n    private _cylMeshOfst: BABYLON.Vector3;\r\n    private _footMesh: BABYLON.Nullable<BABYLON.Mesh>;\r\n    private _footMeshOfst: BABYLON.Vector3;\r\n    private _sceneRenderObserver: BABYLON.Nullable<\r\n        BABYLON.Observer<BABYLON.Scene>\r\n    >;\r\n\r\n    constructor(scene: BABYLON.Scene) {\r\n        super(scene);\r\n\r\n        this._environmentFile = \"Country\";\r\n        this._sceneRenderObserver = null;\r\n        this._boxMesh = null;\r\n        this._boxMaterial = null;\r\n        this._cylMesh = null;\r\n        this._footMesh = null;\r\n\r\n        this.addCollisionVerticalCylinder(\r\n            new BABYLON.Vector3(0.0, -(1.9 + 0.04 - 0.2 + 0.15), 0.0),\r\n            new BABYLON.Vector3(0, 0, 0),\r\n            2.2,\r\n            0.12,\r\n            16,\r\n            null,\r\n            0.3,\r\n            true\r\n        );\r\n\r\n        this.addCollisionPlane(new BABYLON.Vector3(0, 1, 0), 6, 0.3);\r\n\r\n        this.addCollisionCutHollowSphere(\r\n            new BABYLON.Vector3(0.0, 0.2, 0.0),\r\n            new BABYLON.Vector3(0, 0, 0),\r\n            0.5,\r\n            0.2,\r\n            0.02,\r\n            16,\r\n            new BABYLON.Vector3(0, 1, 0)\r\n        );\r\n\r\n        this._footMeshOfst = new BABYLON.Vector3(0, -1.9, 0);\r\n        this.addCollisionVerticalCylinder(\r\n            new BABYLON.Vector3(0.0, -1.7 - 0.04 / 2, 0.0),\r\n            new BABYLON.Vector3(0, 0, 0),\r\n            0.4,\r\n            0.04,\r\n            16,\r\n            null,\r\n            0.6\r\n        );\r\n\r\n        this._cylMeshOfst = new BABYLON.Vector3(0, -1.2, 0);\r\n        this.addCollisionVerticalCylinder(\r\n            new BABYLON.Vector3(0.0, -1.0, 0.0),\r\n            new BABYLON.Vector3(0, 0, 0),\r\n            0.05,\r\n            1.4,\r\n            16,\r\n            null,\r\n            0.6\r\n        );\r\n    }\r\n\r\n    public async _run() {\r\n        // Get collision meshes\r\n        this._boxMesh = this._collisionObjects[2][0];\r\n        this._footMesh = this._collisionObjects[3][0];\r\n        this._cylMesh = this._collisionObjects[4][0];\r\n\r\n        // Reset camera\r\n        const camera =\r\n            this._scene.activeCameras?.[0] ?? this._scene.activeCamera;\r\n\r\n        if (camera) {\r\n            (camera as BABYLON.ArcRotateCamera).alpha = 3.09;\r\n            (camera as BABYLON.ArcRotateCamera).beta = 1.41;\r\n            (camera as BABYLON.ArcRotateCamera).radius = 6.42;\r\n        }\r\n\r\n        // Simulation parameters\r\n        this._fluidRenderObject.object.particleSize = 0.08;\r\n        this._fluidRenderObject.targetRenderer.fluidColor = new BABYLON.Color3(\r\n            251 / 255,\r\n            218 / 255,\r\n            218 / 255\r\n        );\r\n\r\n        this._fluidSim!.smoothingRadius = 0.04;\r\n        this._fluidSim!.densityReference = 20000;\r\n        this._fluidSim!.pressureConstant = 4;\r\n        this._fluidSim!.viscosity = 0.01;\r\n        this._fluidSim!.maxVelocity = 10;\r\n        this._fluidSim!.maxAcceleration = 2000;\r\n\r\n        this._shapeCollisionRestitution = 0.95;\r\n\r\n        this._particleGenerator!.position.x = 0.15;\r\n        this._particleGenerator!.position.y = 0.8;\r\n        this._particleGenerator!.position.z = -0.1;\r\n\r\n        // Create materials\r\n        this._boxMaterial = new BABYLON.PBRMaterial(\"BoxMeshMat\", this._scene);\r\n        this._boxMaterial.metallic = 0.3;\r\n        this._boxMaterial.roughness = 0;\r\n        this._boxMaterial.alpha = 0.2;\r\n        this._boxMaterial.backFaceCulling = false;\r\n\r\n        this._boxMesh!.material = this._boxMaterial;\r\n        this._cylMesh!.material = this._boxMaterial.clone(\"cloned\");\r\n        this._cylMesh!.material.alpha = 1;\r\n        this._footMesh!.material = this._cylMesh!.material;\r\n\r\n        this._sceneRenderObserver = this._scene.onBeforeRenderObservable.add(\r\n            () => {\r\n                this._cylMesh!.position.copyFrom(this._boxMesh!.position);\r\n                this._cylMesh!.position.addInPlace(this._cylMeshOfst);\r\n                this._footMesh!.position.copyFrom(this._boxMesh!.position);\r\n                this._footMesh!.position.addInPlace(this._footMeshOfst);\r\n            }\r\n        );\r\n\r\n        super._run();\r\n\r\n        await BABYLON.SceneLoader.AppendAsync(\"\", tableScene, this._scene);\r\n\r\n        const table = this._scene.getMeshByName(\"Object_3\")!;\r\n\r\n        table.scaling.setAll(6);\r\n        table.position.set(-2.3, -2, -5.54);\r\n    }\r\n\r\n    public dispose(): void {\r\n        super.dispose();\r\n\r\n        this._scene.onBeforeRenderObservable.remove(this._sceneRenderObserver);\r\n\r\n        this._scene.getMeshByName(\"__root__\")?.dispose(false, true);\r\n\r\n        this._boxMesh?.dispose();\r\n        this._boxMaterial?.dispose();\r\n        this._cylMesh?.material?.dispose();\r\n        this._cylMesh?.dispose();\r\n        this._footMesh?.dispose();\r\n    }\r\n\r\n    protected _makeGUIMainMenu(): void {\r\n        const params = {\r\n            restart: () => {\r\n                this._generateParticles();\r\n            },\r\n            boxOpacity: this._boxMaterial!.alpha,\r\n        };\r\n\r\n        const mainMenu = this._gui!;\r\n\r\n        mainMenu.add(params, \"restart\").name(\"Restart\");\r\n\r\n        mainMenu\r\n            .add(params, \"boxOpacity\", 0, 1, 0.01)\r\n            .name(\"Glass opacity\")\r\n            .onChange((value: any) => {\r\n                this._boxMaterial!.alpha = value;\r\n            });\r\n    }\r\n}\r\n"],"names":["FluidSimulationDemoGlass","FluidSimulationDemoBase","constructor","scene","super","this","_environmentFile","_sceneRenderObserver","_boxMesh","_boxMaterial","_cylMesh","_footMesh","addCollisionVerticalCylinder","addCollisionPlane","addCollisionCutHollowSphere","_footMeshOfst","_cylMeshOfst","async","_collisionObjects","camera","_scene","activeCameras","activeCamera","alpha","beta","radius","_fluidRenderObject","object","particleSize","targetRenderer","fluidColor","_fluidSim","smoothingRadius","densityReference","pressureConstant","viscosity","maxVelocity","maxAcceleration","_shapeCollisionRestitution","_particleGenerator","position","x","y","z","metallic","roughness","backFaceCulling","material","clone","onBeforeRenderObservable","add","copyFrom","addInPlace","_run","table","getMeshByName","scaling","setAll","set","dispose","remove","_makeGUIMainMenu","params","restart","_generateParticles","boxOpacity","mainMenu","_gui","name","onChange","value"],"sourceRoot":""}